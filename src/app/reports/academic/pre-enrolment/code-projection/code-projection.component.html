  <mat-card class="example-card">
  <mat-card-header >
    <mat-card-title><b>Subject Projection</b></mat-card-title>
  </mat-card-header>
  
  <mat-card-content class='colo'>
  	<mat-divider></mat-divider>
     <table style="width: 100%">
       <tr style="margin-bottom: -15px">
         <td style="width: 200px">
            <mat-form-field style="width: 200px" appearance="outline" >
              <mat-label>- Select Term -</mat-label>
              <mat-select required  [(ngModel)]="term">
                <mat-option value='2' *ngIf='checkvisibility("2")'>
                  {{global.syDisplay(syDisplay(2))}}
                </mat-option>
                <mat-option value='3' *ngIf='checkvisibility("3")'>
                  {{global.syDisplay(syDisplay(3))}}
                </mat-option>
                <mat-option value='1' *ngIf='checkvisibility("1")'>
                  {{global.syDisplay(syDisplay(1))}}
                </mat-option>
              </mat-select>
            </mat-form-field>
         </td>
         <td style="width: 250px">
            <mat-form-field style="width: 250px" appearance="outline" >
              <mat-label>- Select Department -</mat-label>
              <mat-select  [(ngModel)]="dept">
                <mat-option value="">
                  - All Departments -
                </mat-option>
                <mat-option value="{{a.departmentId}}" *ngFor="let a of global.departments">
                  {{a.departmentCode}} - {{a.departmentName}}
                </mat-option>
              </mat-select>
            </mat-form-field>
         </td>
         <td valign="top" style="width: 100px">
          <button mat-raised-button (click)="getcodeprojection(term)"  style="font-size:12px;min-width:18px;line-height: 15px;height: 28px; padding: 0;background-color:#294a70;color: white;margin-top: 15px;margin-left: 5px">
                  &nbsp;&nbsp;
                  <span style="margin-top: 7px"> Generate&nbsp;&nbsp;&nbsp;</span>
              </button>
         </td>
         <td valign="top">
          <button mat-raised-button (click)="export()" style="font-size:12px;min-width:18px;line-height: 15px;height: 28px; padding: 0;margin-left: 5px;margin-top: 15px;background-color:#006600;color: white;float: right;"   *ngIf="array!=null&&array.length!=0">
            &nbsp;&nbsp;<i class="material-icons">cloud_download
            </i> <span style="margin-top: 7px"> Export to excel&nbsp;&nbsp;&nbsp;</span></button>
         </td>
       </tr>
     </table>
     <table style="margin-top: -20px">
       
       <tr *ngIf="array!=undefined||array!=null">
         <td colspan="4">
           <table>
             <tr>
               <td>
                 <b>Summary:</b>
               </td>
             </tr>
           </table>
         </td>
       </tr>
       <tr *ngIf="array!=undefined||array!=null">
         <td colspan="4">
           <table>
             <tr>
               <td>
                 Total No. of Sets: <b>{{total(array,1)}}</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
               </td>
               <td>
                 Total Lec Rooms: <b>{{total(array,2)}}</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
               </td>
               <td>
                 Total Lab Rooms: <b>{{total(array,3)}}</b>
               </td>
             </tr>
           </table>
         </td>
       </tr>
     </table>
     <div style="height: 5px"></div>
    <div style="width: 100%;max-height: calc(100vh - 400px); overflow-y: scroll;">
    <table class="apptable" *ngIf="array!=null">
	    <tr>
	      <th style="width:80px">Subject ID</th>
	      <th style="min-width:100px">Subject Title</th>
          <th style="width:40px">Year Level</th>
          <th style="width:40px">Units</th>
	      <th style="width:60px">Course</th>
          <th style="width:40px">Version</th>
	      <th style="width:150px">Loading Department</th>
          <th style="width:60px">Class Size</th>
          <th style="width:40px">Projection</th>
          <th style="width:60px">No. of Set</th>
          <th style="width:55px">Lec Rooms</th>
          <th style="width:55px">Lab Rooms</th>
	    </tr>
    	<tr *ngFor="let a of array">
            <td>{{a.subjectId}}</td>
            <td>{{a.subjectTitle}}</td>
            <td>{{a.yearLevel}}</td>
            <td>{{a.units}}</td>
            <td>{{a.course}}</td>
            <td>{{a.version}}</td>
            <td>{{a.loadingDept}}</td>
            <td>{{a.classSize}}</td>
            <td>{{a.projection}}</td>
            <td>{{a.numberOfSet}}</td>
            <td>{{a.lecRooms}}</td>
            <td>{{a.labRooms}}</td>
        </tr>
    </table>    
    </div>              
  <mat-spinner style="margin-left: auto;margin-right: auto;" *ngIf="array===undefined"></mat-spinner>
  <div *ngIf="array!=undefined">
    <p *ngIf="array.length===0" style="text-align: center;"><i>- No result found! -</i></p>
  </div>
  </mat-card-content>
</mat-card>